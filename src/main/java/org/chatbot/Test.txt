// OLD
String injected = copyQuery.inject("atob(arguments[0])");

// NEW (decodes base64 -> bytes -> UTF-8 using TextDecoder)
String injected = copyQuery.inject(
  "(function(s){try{"
+ "var bin=atob(s);"
+ "var len=bin.length;var bytes=new Uint8Array(len);"
+ "for(var i=0;i<len;i++){bytes[i]=bin.charCodeAt(i)&255;}"
+ "return new TextDecoder('utf-8').decode(bytes);"
+ "}catch(e){return ''+e;}})(arguments[0])"
);


<script>
  /* ...existing code... */

  // UTF-8 safe Base64 encoder for arbitrary Unicode text
  function b64FromUtf8(str){
    const enc = new TextEncoder().encode(str);    // UTF-8 bytes
    let bin = '';
    const CHUNK = 0x8000;                         // avoid call stack limits
    for (let i=0; i<enc.length; i+=CHUNK) {
      const sub = enc.subarray(i, Math.min(i+CHUNK, enc.length));
      bin += String.fromCharCode.apply(null, sub);
    }
    return btoa(bin);
  }

  /* ... keep the rest ... */
</script>
